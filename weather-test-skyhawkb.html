
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-gb" lang="en-gb">
  <head>
    <title>Weather test, skyhawkb</title>
    <!--<script src="https://d3js.org/d3.v4.min.js"></script>-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.6.0/Chart.min.js"></script>

	</head>
	<body>
    <div id="info"></div>
    <div id="list"></div>

    <div style="width: 800px;">
      <canvas id="streaks"></canvas>
    </div>

		<script>
		function randomInt(min,max) {
				return Math.floor(Math.random()*(max-min+1)+min);
		} // credit francisc at stack overflow


    let previousWeather = [false];

    /**
     * @return {boolean} True if rain.
     */
		function getWeather() {
      //console.log(previousWeather);
      let isRain = previousWeather[previousWeather.length - 1];
      let change = randomInt(1,10);
      if(change < 3 && isRain) {
        isRain = !isRain;
      } else if(change < 5 && !isRain) {
        isRain = !isRain;
      }
      previousWeather.push(isRain);
      return isRain;
    }

    // Return number of rain streaks.
    function getNumberOfStreaks(list) {
      let streaks = 0;
      let isStreak = true;
      let streakLength;
      let streakLengths = [];
      for (let i = 0; i < list.length; i++) {
        let rain = list[i];
        if (rain && list[i - 1]) {
          if (!isStreak) {
            streaks++;
          }
          isStreak = true;
          streakLength++;
        } else {
          isStreak = false;
          if (streakLength > 0) {
            streakLengths.push(streakLength);
          }
          streakLength = 0;
        }
      }
      return streakLengths;
    }

		let list = [];
    let chars = '';
    let totalDays = 1000;
    let rainyDays = 0;
    let yesterdayRain = false;
    let isStreak = false;
    let longestStreak = 0;
    let RAIN = 1;
    let DRY = 0;
		for(let i = 0; i < totalDays; i++) {
      if (getWeather()) {
        list.push(RAIN);
        chars += 'R<br/>';
      } else {
        list.push(DRY);
        chars += 'D<br/>';
      }
    }
    var streaks = getNumberOfStreaks(list);
    document.getElementById('info').innerHTML = `
      <p>Total days: ${totalDays}</p>
      <p>Rain streaks: ${streaks.length}</p>
    `;

    streaks.sort((a, b) => { return b - a;});
    let ctx = document.getElementById("streaks").getContext('2d');
    let options = {};
    console.log(streaks);
    let myLineChart = new Chart(ctx, {
      type: 'line',
      data: {
        labels: streaks,
        datasets: [
          {
            label: 'Length of streak',
            data: streaks
          }
        ]
      },
      options: {
        'label': 'bla'
      }
    });
		/*
		var myChart = new Chart(ctx, {
				type: 'bar',
				data: {
						labels: ["Red", "Blue", "Yellow", "Green", "Purple", "Orange"],
						datasets: [{
								label: '# of Votes',
								data: [12, 19, 3, 5, 2, 3],
								backgroundColor: [
										'rgba(255, 99, 132, 0.2)',
										'rgba(54, 162, 235, 0.2)',
										'rgba(255, 206, 86, 0.2)',
										'rgba(75, 192, 192, 0.2)',
										'rgba(153, 102, 255, 0.2)',
										'rgba(255, 159, 64, 0.2)'
								],
								borderColor: [
										'rgba(255,99,132,1)',
										'rgba(54, 162, 235, 1)',
										'rgba(255, 206, 86, 1)',
										'rgba(75, 192, 192, 1)',
										'rgba(153, 102, 255, 1)',
										'rgba(255, 159, 64, 1)'
								],
								borderWidth: 1
						}]
				},
				options: {
						scales: {
								yAxes: [{
										ticks: {
												beginAtZero:true
										}
								}]
						}
				}
		});
		*/
		</script>

	</body>
</html>
